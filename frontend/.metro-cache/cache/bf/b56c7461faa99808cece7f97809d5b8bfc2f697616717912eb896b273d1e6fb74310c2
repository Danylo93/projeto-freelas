{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"yg7e6laZwmpbIvId5jovq9ugXp8=","exportNames":["*"]}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"Z6pzkVZ2fvxBLkFTgVVOy4UDj30=","exportNames":["*"]}},{"name":"@babel/runtime/helpers/possibleConstructorReturn","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"aU3Lrys8xTVpYSDJal2nhppojC8=","exportNames":["*"]}},{"name":"@babel/runtime/helpers/getPrototypeOf","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"4DwyfFXBA53CJWVTVj5w3kH1PUg=","exportNames":["*"]}},{"name":"@babel/runtime/helpers/inherits","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"y0uNg4LxF1CLscQChxzgo5dfjvA=","exportNames":["*"]}},{"name":"./polling.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":39,"index":39}}],"key":"Pl+iaQVK3G0OaUHovkJUbWBEusk=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.Fetch = void 0;\n  var _classCallCheck2 = _interopRequireDefault(require(_dependencyMap[1], \"@babel/runtime/helpers/classCallCheck\"));\n  var _createClass2 = _interopRequireDefault(require(_dependencyMap[2], \"@babel/runtime/helpers/createClass\"));\n  var _possibleConstructorReturn2 = _interopRequireDefault(require(_dependencyMap[3], \"@babel/runtime/helpers/possibleConstructorReturn\"));\n  var _getPrototypeOf2 = _interopRequireDefault(require(_dependencyMap[4], \"@babel/runtime/helpers/getPrototypeOf\"));\n  var _inherits2 = _interopRequireDefault(require(_dependencyMap[5], \"@babel/runtime/helpers/inherits\"));\n  var _polling = require(_dependencyMap[6], \"./polling.js\");\n  function _callSuper(t, o, e) { return o = (0, _getPrototypeOf2.default)(o), (0, _possibleConstructorReturn2.default)(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], (0, _getPrototypeOf2.default)(t).constructor) : o.apply(t, e)); }\n  function _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function () { return !!t; })(); }\n  /**\n   * HTTP long-polling based on the built-in `fetch()` method.\n   *\n   * Usage: browser, Node.js (since v18), Deno, Bun\n   *\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/fetch\n   * @see https://caniuse.com/fetch\n   * @see https://nodejs.org/api/globals.html#fetch\n   */\n  var Fetch = exports.Fetch = /*#__PURE__*/function (_Polling) {\n    function Fetch() {\n      (0, _classCallCheck2.default)(this, Fetch);\n      return _callSuper(this, Fetch, arguments);\n    }\n    (0, _inherits2.default)(Fetch, _Polling);\n    return (0, _createClass2.default)(Fetch, [{\n      key: \"doPoll\",\n      value: function doPoll() {\n        this._fetch().then(res => {\n          if (!res.ok) {\n            return this.onError(\"fetch read error\", res.status, res);\n          }\n          res.text().then(data => this.onData(data));\n        }).catch(err => {\n          this.onError(\"fetch read error\", err);\n        });\n      }\n    }, {\n      key: \"doWrite\",\n      value: function doWrite(data, callback) {\n        this._fetch(data).then(res => {\n          if (!res.ok) {\n            return this.onError(\"fetch write error\", res.status, res);\n          }\n          callback();\n        }).catch(err => {\n          this.onError(\"fetch write error\", err);\n        });\n      }\n    }, {\n      key: \"_fetch\",\n      value: function _fetch(data) {\n        var _a;\n        var isPost = data !== undefined;\n        var headers = new Headers(this.opts.extraHeaders);\n        if (isPost) {\n          headers.set(\"content-type\", \"text/plain;charset=UTF-8\");\n        }\n        (_a = this.socket._cookieJar) === null || _a === void 0 ? void 0 : _a.appendCookies(headers);\n        return fetch(this.uri(), {\n          method: isPost ? \"POST\" : \"GET\",\n          body: isPost ? data : null,\n          headers,\n          credentials: this.opts.withCredentials ? \"include\" : \"omit\"\n        }).then(res => {\n          var _a;\n          // @ts-ignore getSetCookie() was added in Node.js v19.7.0\n          (_a = this.socket._cookieJar) === null || _a === void 0 ? void 0 : _a.parseCookies(res.headers.getSetCookie());\n          return res;\n        });\n      }\n    }]);\n  }(_polling.Polling);\n});","lineCount":78,"map":[[12,2,1,0],[12,6,1,0,"_polling"],[12,14,1,0],[12,17,1,0,"require"],[12,24,1,0],[12,25,1,0,"_dependencyMap"],[12,39,1,0],[13,2,1,39],[13,11,1,39,"_callSuper"],[13,22,1,39,"t"],[13,23,1,39],[13,25,1,39,"o"],[13,26,1,39],[13,28,1,39,"e"],[13,29,1,39],[13,40,1,39,"o"],[13,41,1,39],[13,48,1,39,"_getPrototypeOf2"],[13,64,1,39],[13,65,1,39,"default"],[13,72,1,39],[13,74,1,39,"o"],[13,75,1,39],[13,82,1,39,"_possibleConstructorReturn2"],[13,109,1,39],[13,110,1,39,"default"],[13,117,1,39],[13,119,1,39,"t"],[13,120,1,39],[13,122,1,39,"_isNativeReflectConstruct"],[13,147,1,39],[13,152,1,39,"Reflect"],[13,159,1,39],[13,160,1,39,"construct"],[13,169,1,39],[13,170,1,39,"o"],[13,171,1,39],[13,173,1,39,"e"],[13,174,1,39],[13,186,1,39,"_getPrototypeOf2"],[13,202,1,39],[13,203,1,39,"default"],[13,210,1,39],[13,212,1,39,"t"],[13,213,1,39],[13,215,1,39,"constructor"],[13,226,1,39],[13,230,1,39,"o"],[13,231,1,39],[13,232,1,39,"apply"],[13,237,1,39],[13,238,1,39,"t"],[13,239,1,39],[13,241,1,39,"e"],[13,242,1,39],[14,2,1,39],[14,11,1,39,"_isNativeReflectConstruct"],[14,37,1,39],[14,51,1,39,"t"],[14,52,1,39],[14,56,1,39,"Boolean"],[14,63,1,39],[14,64,1,39,"prototype"],[14,73,1,39],[14,74,1,39,"valueOf"],[14,81,1,39],[14,82,1,39,"call"],[14,86,1,39],[14,87,1,39,"Reflect"],[14,94,1,39],[14,95,1,39,"construct"],[14,104,1,39],[14,105,1,39,"Boolean"],[14,112,1,39],[14,145,1,39,"t"],[14,146,1,39],[14,159,1,39,"_isNativeReflectConstruct"],[14,184,1,39],[14,196,1,39,"_isNativeReflectConstruct"],[14,197,1,39],[14,210,1,39,"t"],[14,211,1,39],[15,2,2,0],[16,0,3,0],[17,0,4,0],[18,0,5,0],[19,0,6,0],[20,0,7,0],[21,0,8,0],[22,0,9,0],[23,0,10,0],[24,2,2,0],[24,6,11,13,"Fetch"],[24,11,11,18],[24,14,11,18,"exports"],[24,21,11,18],[24,22,11,18,"Fetch"],[24,27,11,18],[24,53,11,18,"_Polling"],[24,61,11,18],[25,4,11,18],[25,13,11,18,"Fetch"],[25,19,11,18],[26,6,11,18],[26,10,11,18,"_classCallCheck2"],[26,26,11,18],[26,27,11,18,"default"],[26,34,11,18],[26,42,11,18,"Fetch"],[26,47,11,18],[27,6,11,18],[27,13,11,18,"_callSuper"],[27,23,11,18],[27,30,11,18,"Fetch"],[27,35,11,18],[27,37,11,18,"arguments"],[27,46,11,18],[28,4,11,18],[29,4,11,18],[29,8,11,18,"_inherits2"],[29,18,11,18],[29,19,11,18,"default"],[29,26,11,18],[29,28,11,18,"Fetch"],[29,33,11,18],[29,35,11,18,"_Polling"],[29,43,11,18],[30,4,11,18],[30,15,11,18,"_createClass2"],[30,28,11,18],[30,29,11,18,"default"],[30,36,11,18],[30,38,11,18,"Fetch"],[30,43,11,18],[31,6,11,18,"key"],[31,9,11,18],[32,6,11,18,"value"],[32,11,11,18],[32,13,12,4],[32,22,12,4,"doPoll"],[32,28,12,10,"doPoll"],[32,29,12,10],[32,31,12,13],[33,8,13,8],[33,12,13,12],[33,13,13,13,"_fetch"],[33,19,13,19],[33,20,13,20],[33,21,13,21],[33,22,14,13,"then"],[33,26,14,17],[33,27,14,19,"res"],[33,30,14,22],[33,34,14,27],[34,10,15,12],[34,14,15,16],[34,15,15,17,"res"],[34,18,15,20],[34,19,15,21,"ok"],[34,21,15,23],[34,23,15,25],[35,12,16,16],[35,19,16,23],[35,23,16,27],[35,24,16,28,"onError"],[35,31,16,35],[35,32,16,36],[35,50,16,54],[35,52,16,56,"res"],[35,55,16,59],[35,56,16,60,"status"],[35,62,16,66],[35,64,16,68,"res"],[35,67,16,71],[35,68,16,72],[36,10,17,12],[37,10,18,12,"res"],[37,13,18,15],[37,14,18,16,"text"],[37,18,18,20],[37,19,18,21],[37,20,18,22],[37,21,18,23,"then"],[37,25,18,27],[37,26,18,29,"data"],[37,30,18,33],[37,34,18,38],[37,38,18,42],[37,39,18,43,"onData"],[37,45,18,49],[37,46,18,50,"data"],[37,50,18,54],[37,51,18,55],[37,52,18,56],[38,8,19,8],[38,9,19,9],[38,10,19,10],[38,11,20,13,"catch"],[38,16,20,18],[38,17,20,20,"err"],[38,20,20,23],[38,24,20,28],[39,10,21,12],[39,14,21,16],[39,15,21,17,"onError"],[39,22,21,24],[39,23,21,25],[39,41,21,43],[39,43,21,45,"err"],[39,46,21,48],[39,47,21,49],[40,8,22,8],[40,9,22,9],[40,10,22,10],[41,6,23,4],[42,4,23,5],[43,6,23,5,"key"],[43,9,23,5],[44,6,23,5,"value"],[44,11,23,5],[44,13,24,4],[44,22,24,4,"doWrite"],[44,29,24,11,"doWrite"],[44,30,24,12,"data"],[44,34,24,16],[44,36,24,18,"callback"],[44,44,24,26],[44,46,24,28],[45,8,25,8],[45,12,25,12],[45,13,25,13,"_fetch"],[45,19,25,19],[45,20,25,20,"data"],[45,24,25,24],[45,25,25,25],[45,26,26,13,"then"],[45,30,26,17],[45,31,26,19,"res"],[45,34,26,22],[45,38,26,27],[46,10,27,12],[46,14,27,16],[46,15,27,17,"res"],[46,18,27,20],[46,19,27,21,"ok"],[46,21,27,23],[46,23,27,25],[47,12,28,16],[47,19,28,23],[47,23,28,27],[47,24,28,28,"onError"],[47,31,28,35],[47,32,28,36],[47,51,28,55],[47,53,28,57,"res"],[47,56,28,60],[47,57,28,61,"status"],[47,63,28,67],[47,65,28,69,"res"],[47,68,28,72],[47,69,28,73],[48,10,29,12],[49,10,30,12,"callback"],[49,18,30,20],[49,19,30,21],[49,20,30,22],[50,8,31,8],[50,9,31,9],[50,10,31,10],[50,11,32,13,"catch"],[50,16,32,18],[50,17,32,20,"err"],[50,20,32,23],[50,24,32,28],[51,10,33,12],[51,14,33,16],[51,15,33,17,"onError"],[51,22,33,24],[51,23,33,25],[51,42,33,44],[51,44,33,46,"err"],[51,47,33,49],[51,48,33,50],[52,8,34,8],[52,9,34,9],[52,10,34,10],[53,6,35,4],[54,4,35,5],[55,6,35,5,"key"],[55,9,35,5],[56,6,35,5,"value"],[56,11,35,5],[56,13,36,4],[56,22,36,4,"_fetch"],[56,28,36,10,"_fetch"],[56,29,36,11,"data"],[56,33,36,15],[56,35,36,17],[57,8,37,8],[57,12,37,12,"_a"],[57,14,37,14],[58,8,38,8],[58,12,38,14,"isPost"],[58,18,38,20],[58,21,38,23,"data"],[58,25,38,27],[58,30,38,32,"undefined"],[58,39,38,41],[59,8,39,8],[59,12,39,14,"headers"],[59,19,39,21],[59,22,39,24],[59,26,39,28,"Headers"],[59,33,39,35],[59,34,39,36],[59,38,39,40],[59,39,39,41,"opts"],[59,43,39,45],[59,44,39,46,"extraHeaders"],[59,56,39,58],[59,57,39,59],[60,8,40,8],[60,12,40,12,"isPost"],[60,18,40,18],[60,20,40,20],[61,10,41,12,"headers"],[61,17,41,19],[61,18,41,20,"set"],[61,21,41,23],[61,22,41,24],[61,36,41,38],[61,38,41,40],[61,64,41,66],[61,65,41,67],[62,8,42,8],[63,8,43,8],[63,9,43,9,"_a"],[63,11,43,11],[63,14,43,14],[63,18,43,18],[63,19,43,19,"socket"],[63,25,43,25],[63,26,43,26,"_cookieJar"],[63,36,43,36],[63,42,43,42],[63,46,43,46],[63,50,43,50,"_a"],[63,52,43,52],[63,57,43,57],[63,62,43,62],[63,63,43,63],[63,66,43,66],[63,71,43,71],[63,72,43,72],[63,75,43,75,"_a"],[63,77,43,77],[63,78,43,78,"appendCookies"],[63,91,43,91],[63,92,43,92,"headers"],[63,99,43,99],[63,100,43,100],[64,8,44,8],[64,15,44,15,"fetch"],[64,20,44,20],[64,21,44,21],[64,25,44,25],[64,26,44,26,"uri"],[64,29,44,29],[64,30,44,30],[64,31,44,31],[64,33,44,33],[65,10,45,12,"method"],[65,16,45,18],[65,18,45,20,"isPost"],[65,24,45,26],[65,27,45,29],[65,33,45,35],[65,36,45,38],[65,41,45,43],[66,10,46,12,"body"],[66,14,46,16],[66,16,46,18,"isPost"],[66,22,46,24],[66,25,46,27,"data"],[66,29,46,31],[66,32,46,34],[66,36,46,38],[67,10,47,12,"headers"],[67,17,47,19],[68,10,48,12,"credentials"],[68,21,48,23],[68,23,48,25],[68,27,48,29],[68,28,48,30,"opts"],[68,32,48,34],[68,33,48,35,"withCredentials"],[68,48,48,50],[68,51,48,53],[68,60,48,62],[68,63,48,65],[69,8,49,8],[69,9,49,9],[69,10,49,10],[69,11,49,11,"then"],[69,15,49,15],[69,16,49,17,"res"],[69,19,49,20],[69,23,49,25],[70,10,50,12],[70,14,50,16,"_a"],[70,16,50,18],[71,10,51,12],[72,10,52,12],[72,11,52,13,"_a"],[72,13,52,15],[72,16,52,18],[72,20,52,22],[72,21,52,23,"socket"],[72,27,52,29],[72,28,52,30,"_cookieJar"],[72,38,52,40],[72,44,52,46],[72,48,52,50],[72,52,52,54,"_a"],[72,54,52,56],[72,59,52,61],[72,64,52,66],[72,65,52,67],[72,68,52,70],[72,73,52,75],[72,74,52,76],[72,77,52,79,"_a"],[72,79,52,81],[72,80,52,82,"parseCookies"],[72,92,52,94],[72,93,52,95,"res"],[72,96,52,98],[72,97,52,99,"headers"],[72,104,52,106],[72,105,52,107,"getSetCookie"],[72,117,52,119],[72,118,52,120],[72,119,52,121],[72,120,52,122],[73,10,53,12],[73,17,53,19,"res"],[73,20,53,22],[74,8,54,8],[74,9,54,9],[74,10,54,10],[75,6,55,4],[76,4,55,5],[77,2,55,5],[77,4,11,27,"Polling"],[77,20,11,34],[78,0,11,34],[78,3]],"functionMap":{"names":["<global>","Fetch","Fetch#doPoll","_fetch.then$argument_0","res.text.then$argument_0","_fetch.then._catch$argument_0","Fetch#doWrite","Fetch#_fetch","fetch.then$argument_0"],"mappings":"AAA;OCU;ICC;kBCE;4BCI,2BD;SDC;mBGC;SHE;KDC;IKC;kBHE;SGK;mBDC;SCE;KLC;IMC;gBCa;SDK;KNC;CDC"}},"type":"js/module"}]}